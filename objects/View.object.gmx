<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>-1</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Set up the view
display_set_gui_size(view_wport[0],view_hport[0]);
global.window_width = view_wport[0];
global.window_height = view_hport[0];
surface_resize(application_surface, view_wview[0], view_hview[0]);
//application_surface_enable(false);
// Set GUI size

screen_scale = 1;
prev_screen_scale = screen_scale;


// We do not start in a menu
in_menu = false;

// Set the various menus to not open (TODO: should these vars be in the respective menus?
// ...cont Then we wouldn't have to pass them to the toggle_menu script separately)
pause_menu_open = false;
map_open = false;
inv_open = false;
menu_open = false;

instance_create(-999,-999,Inventory);
instance_create(-999,-999,Map);
instance_deactivate_object(Menu_Parent);
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Move to player
if (instance_exists(Player)) {
    x = Player.x;
    y = Player.y;
}

global.screen_shake = 0;

// Get the screen shake decay going
alarm[0] = 1;
alarm[1] = 1;
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Init menus
hud = ds_list_create();
ds_list_add(hud,HUD);

inventory = ds_list_create();
ds_list_add(inventory, Inventory);

map = ds_list_create();
ds_list_add(map, Map);

cast_mode = ds_list_create();
ds_list_add(cast_mode, Cast_Mode);

// Initial
menu = noone;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Handle instance activation
if (!in_menu) {
    scr_handle_deactivation(noone);
    with (Drop_Parent) scr_update_drop_tooltip(object_index);
}
alarm[1] = .5 * room_speed;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Screen shake decay
if (global.screen_shake &gt;= 2) {
    global.screen_shake -= 2;
}
alarm[0] = .2 * room_speed;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Move view0 10% toward player and screen shake

if (instance_exists(Player)) {
    var dis;
    if (global.cast_mode) {
        x += (Player.x - x) * .3;
        y += (Player.y - y) * .3;
    } else {
        if (os_type = os_android) {
            dis = 128;
        } else {
            dis = point_distance(Player.x,Player.y,mouse_x,mouse_y);
        }
        var targetx = Player.x + lengthdir_x(dis/5,global.mousedir);
        var targety = Player.y + lengthdir_y(dis/5,global.mousedir);
        
        global.crosshair_x = targetx;
        global.crosshair_y = targety;
    
        x += (targetx - x) * .1  * (30/room_speed);
        y += (targety - y) * .1 * (30/room_speed);
    
    }
}

if (global.screen_shake &gt; 4) {
    if (global.screen_shake &gt; 6) global.screen_shake = 8;
    x += choose(-random(global.screen_shake),random(global.screen_shake)) * (30/room_speed);
    y += choose(-random(global.screen_shake),random(global.screen_shake)) * (30/room_speed);
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// In cast mode, get larger

if (global.cast_mode) {
   if (screen_scale &lt; 1.2) screen_scale += .05;
} else {
   if (screen_scale &gt; 1) screen_scale -= .05;
}

// Scale the view if the screen scale has changed
if (prev_screen_scale != screen_scale) scr_scale_view(screen_scale*320,screen_scale*180);

prev_screen_scale = screen_scale;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="77">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Show map
map_open = scr_toggle(map_open);

// If the menu open variable is now on, send the menu object to the deactivation handler
if (map_open) {
    // Make sure we know we're in a menu
    in_menu = true;
    scr_handle_deactivation(map);
    scr_activate_map();
} else {
    // Make sure we know we're not in a menu
    in_menu = false;
    scr_handle_deactivation(noone);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="73">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Open inventory
inv_open = scr_toggle(inv_open);

// If the menu open variable is now on, send the menu object to the deactivation handler
if (inv_open) {
    // Make sure we know we're in a menu
    in_menu = true;
    scr_handle_deactivation(inventory);
    scr_activate_inv();
} else {
    // Make sure we know we're not in a menu
    in_menu = false;
    scr_handle_deactivation(noone);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="27">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Pause the game
if (in_menu) {
    scr_handle_deactivation(noone);
    in_menu = false;
} else {
    in_menu = true;
    scr_handle_deactivation(Pause_Menu);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
